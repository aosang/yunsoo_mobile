{"version":3,"file":"workorder.js","sources":["pages/workorder/workorder.vue","D:/software/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvd29ya29yZGVyL3dvcmtvcmRlci52dWU"],"sourcesContent":["<template>\r\n\t<Navigation />\r\n\t<wd-toast />\r\n\t<wd-message-box :zIndex=\"1000\" />\r\n\t<view class=\"workorder_list\">\r\n\t\t<wd-navbar \r\n\t\t\ttitle=\"我的工单\" \r\n\t\t\tfixed \r\n\t\t\tcustom-class=\"custom\" \r\n\t\t\tright-text=\"添加\"\r\n\t\t\t@click-right=\"goToCreateWorkorder\"\r\n\t\t\t:zIndex=\"10\"\r\n\t\t>\r\n\t\t</wd-navbar>\r\n\t</view>\r\n\t<view class=\"workorder_tab\">\r\n\t\t<wd-tabs \r\n\t\t\tv-model=\"tabNum\"  \r\n\t\t\tautoLineWidth \r\n\t\t\tcolor=\"#2a6fff\"\r\n\t\t\tsticky\r\n\t\t\t:offset-top=\"90\"\r\n\t\t\tinactiveColor=\"#333\"\r\n\t\t\tcustom-class=\"custom-tabs\"\r\n\t\t\t@click=\"changeGetWorkorderList\"\r\n\t\t>\r\n\t\t\t<view class=\"workorder_loading\" v-if=\"isLoading\">\r\n\t\t\t\t<wd-loading v-if=\"isLoading\" />\r\n\t\t\t</view>\r\n\t\t\t<block v-for=\"item in tabText\" :key=\"item.id\">\r\n\t\t\t\t<wd-tab :title=\"item.text\">\r\n\t\t\t\t\t<view class=\"workorder_box\">\r\n\t\t\t\t\t\t<view class=\"empty_data\" v-if=\"!isLoading && workOrderListData.length === 0\">\r\n\t\t\t\t\t\t\t<wd-status-tip image=\"content\" tip=\"暂无工单\" />\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<wd-swipe-action\r\n\t\t\t\t\t\t\tv-if=\"!isLoading && workOrderListData.length !== 0\"\r\n\t\t\t\t\t\t\tclass=\"workorder_item\"\r\n\t\t\t\t\t\t\tv-for=\"item in workOrderListData\"\r\n\t\t\t\t\t\t\t:key=\"item.created_id\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<view \r\n\t\t\t\t\t\t\t\tclass=\"workorder_list_item\"\r\n\t\t\t\t\t\t\t\t@click=\"goToWorkorderDetails(item.created_id)\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<view \r\n\t\t\t\t\t\t\t\t\tclass=\"device_status\" \r\n\t\t\t\t\t\t\t\t\t:class=\"item.created_status === '已解决'? 'device_finish' : ''\"\r\n\t\t\t\t\t\t\t\t\tv-if=\"item.created_status === '已解决'\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t已解决\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t<view\r\n\t\t\t\t\t\t\t\t\tclass=\"device_status\" \r\n\t\t\t\t\t\t\t\t\t:class=\"item.created_status === '待处理'? 'device_wait' : ''\"\r\n\t\t\t\t\t\t\t\t\tv-if=\"item.created_status === '待处理'\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t待处理\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t<view\r\n\t\t\t\t\t\t\t\t\tclass=\"device_status\" \r\n\t\t\t\t\t\t\t\t\t:class=\"item.created_status === '处理中'? 'device_process' : ''\"\r\n\t\t\t\t\t\t\t\t\tv-if=\"item.created_status === '处理中'\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t处理中\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t<view class=\"device_box\">\r\n\t\t\t\t\t\t\t\t\t<text class=\"device_box_title\">设备名称：</text>\r\n\t\t\t\t\t\t\t\t\t<text class=\"device_box_text\">{{item.created_product}}</text>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t<view class=\"device_box\">\r\n\t\t\t\t\t\t\t\t\t<text class=\"device_box_title\">设备类型：</text>\r\n\t\t\t\t\t\t\t\t\t<text class=\"device_box_text\">{{item.created_type}}</text>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t<view class=\"device_box\">\r\n\t\t\t\t\t\t\t\t\t<text class=\"device_box_title\">设备品牌：</text>\r\n\t\t\t\t\t\t\t\t\t<text class=\"device_box_text\">{{item.created_brand}}</text>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t<view class=\"device_box\">\r\n\t\t\t\t\t\t\t\t\t<text class=\"device_box_title\">更新时间：</text>\r\n\t\t\t\t\t\t\t\t\t<text class=\"device_box_text\">{{item.created_update}}</text>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t<view class=\"device_box\">\r\n\t\t\t\t\t\t\t\t\t<text class=\"device_box_title\">问题描述：</text>\r\n\t\t\t\t\t\t\t\t\t<text class=\"device_box_text\">{{item.created_text}}</text>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<template #right>\r\n\t\t\t\t\t\t\t\t<view class=\"device_action\">\r\n\t\t\t\t\t\t\t\t\t<view \r\n\t\t\t\t\t\t\t\t\t\tclass=\"device_button\" \r\n\t\t\t\t\t\t\t\t\t\t@click=\"deleteWorkorderData(item.created_id)\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t删除\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t</wd-swipe-action>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</wd-tab>\r\n\t\t\t</block>\r\n\t\t</wd-tabs>\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\r\n\timport Navigation from '@/components/navigation_header.vue'\r\n\timport { nextTick, onMounted, reactive, ref, watch } from 'vue';\r\n\timport { onPullDownRefresh, onShow } from '@dcloudio/uni-app'\r\n\timport { requestMethods } from '@/request/request.js'\r\n\timport { useToast, useMessage } from '@/uni_modules/wot-design-uni'\r\n\tconst toast = useToast()\r\n\tconst message = useMessage()\r\n\timport { userInfoStore } from '@/stores/userInfo';\r\n\tconst userStore = userInfoStore()\r\n\r\n\tconst tabNum = ref(0)\r\n\tconst isLoading = ref(true)\r\n\t\r\n\tconst workOrderListData = ref([])\r\n\tlet userId = ref('')\r\n\tconst tabText = reactive([{\r\n\t\tid: 1,\r\n\t\ttext: '全部'\r\n\t}, {\r\n\t\tid: 2,\r\n\t\ttext: '已解决'\r\n\t}, {\r\n\t\tid: 3,\r\n\t\ttext: '处理中'\r\n\t}, {\r\n\t\tid: 4,\r\n\t\ttext: '待处理'\r\n\t}])\r\n\t\r\n\tonMounted(() => {\r\n\t\t// 新增工单成功后自动刷新数据\r\n\t\tuni.$on('refreshData', () => {\r\n\t\t\tgetWorkorderData(userStore.userId ,tabNum.value)\r\n\t\t})\r\n\t\tnextTick(() => {\r\n\t\t\tgetWorkorderData(userStore.userId ,tabNum.value)\r\n\t\t})\t\t\r\n\t})\r\n\t\r\n\tonPullDownRefresh(() => {\r\n\t\tgetWorkorderData(userStore.userId ,tabNum.value)\r\n\t})\r\n\t\r\n\tconst changeGetWorkorderList = () => {\r\n\t\tif(!isLoading.value) {\r\n\t\t\tgetWorkorderData(userStore.userId, tabNum.value)\r\n\t\t}\r\n\t}\r\n\t\r\n\tconst getWorkorderData = async (id, num) => {\r\n\t\tlet res = await requestMethods('/GetWorkorder', 'GET', {\r\n\t\t\tuserId: id,\r\n\t\t\ttabId: num\r\n\t\t})\r\n\t\tif(res.code === 200) {\r\n\t\t\tworkOrderListData.value = res.data || []\r\n\t\t\tisLoading.value = false\r\n\t\t\tuni.stopPullDownRefresh()\r\n\t\t}else {\r\n\t\t\ttoast.error('获取数据失败')\r\n\t\t\tisLoading.value = false\r\n\t\t\tuni.stopPullDownRefresh()\r\n\t\t}\r\n\t}\r\n\t\r\n\t// 跳转工单详情页\r\n\tconst goToWorkorderDetails = (id) => {\r\n\t\tuni.navigateTo({\r\n\t\t\turl: `/pages/workorderDetails/workorderDetails?workId=${id}`\r\n\t\t})\r\n\t}\r\n\t\r\n\t// 删除工单\r\n\tconst deleteWorkorderData = (id) => {\r\n\t\tmessage.confirm({\r\n\t\t\ttitle: '提示',\r\n\t\t\tmsg: '确认要删除此工单吗',\r\n\t\t})\r\n\t\t.then(async () => {\r\n\t\t\tlet res = await requestMethods('/DeleteWorkorder', 'POST', {\r\n\t\t\t\tdelId: id\r\n\t\t\t})\r\n\t\t\tif(res.code === 200) {\r\n\t\t\t\ttoast.show({\r\n\t\t\t\t\tmsg: '工单已删除',\r\n\t\t\t\t\tduration: 800,\r\n\t\t\t\t\ticonName: 'success',\r\n\t\t\t\t\tclosed: () => {\r\n\t\t\t\t\t\tgetWorkorderData(userStore.userId, tabNum.value)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}else {\r\n\t\t\t\ttoast.error('删除失败')\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(() => {\r\n\t\t\t// console.log('取消')\r\n\t\t})\r\n\t}\r\n\t\r\n\tconst goToCreateWorkorder = () => {\r\n\t\tuni.navigateTo({\r\n\t\t\turl: '/pages/createWorkorder/createWorkorder'\r\n\t\t})\r\n\t}\t\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\t.workorder_tab {\r\n\t\t:deep() {\r\n\t\t\t.custom-tabs {\r\n\t\t\t\tmargin-top: 128rpx;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t.workorder_loading {\r\n\t\t\tdisplay: flex;\r\n\t\t\tpadding-top: 200rpx;\r\n\t\t\tjustify-content: center;\r\n\t\t\talign-items: center;\r\n\t\t}\r\n\t}\r\n\t\r\n\t.workorder_list {\r\n\t\t:deep() {\r\n\t\t\twidth: 100%;\r\n\t\t\tmargin: 40rpx auto 0 auto;\r\n\t\t\t.custom {\r\n\t\t\t\tbackground-color: #2a6fff;\r\n\t\t\t\tmargin-top: 88rpx;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t.device_action {\r\n\t\tdisplay: block;\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t}\r\n\r\n\t.device_button {\r\n\t\tpadding: 0 24rpx;\r\n\t\theight: 100%;\r\n\t\tcolor: #fff;\r\n\t\tbackground: #fa4350;\r\n\t\tfont-size: 28rpx;\r\n\t\tline-height: 300rpx;\r\n\t}\r\n\r\n\t.workorder_box {\r\n\t\twidth: 680rpx;\r\n\t\tmargin: 24rpx auto 0 auto;\r\n\r\n\t\t.workorder_item {\r\n\t\t\tbox-shadow: 0 0 15rpx rgba(0, 0, 0, 0.2);\r\n\t\t\tmargin-bottom: 30rpx;\r\n\t\t\tborder-radius: 10rpx;\r\n\t\t}\r\n\r\n\t\t.workorder_list_item {\r\n\t\t\tposition: relative;\r\n\t\t\twidth: 100%;\r\n\t\t\tbackground: #fff;\r\n\t\t\tborder-radius: 10rpx;\r\n\t\t\tpadding: 24rpx;\r\n\t\t\tbox-sizing: border-box;\r\n\r\n\t\t\t.device_status {\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\ttop: 24rpx;\r\n\t\t\t\tright: 24rpx;\r\n\t\t\t\twidth: 130rpx;\r\n\t\t\t\tpadding: 6rpx 0;\r\n\t\t\t\t// background: #34d19d;\r\n\t\t\t\t// background: #fa4350;\r\n\t\t\t\t// background: #f0883a;\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tcolor: #fff;\r\n\t\t\t\tborder-radius: 4rpx;\r\n\t\t\t\ttext-align: center;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.device_wait {\r\n\t\t\t\tbackground: #f0883a;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.device_finish {\r\n\t\t\t\tbackground: #34d19d;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.device_process {\r\n\t\t\t\tbackground: #fa4350;\r\n\t\t\t}\r\n\r\n\t\t\t.device_box {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tmargin-bottom: 12rpx;\r\n\r\n\t\t\t\t.device_box_title {\r\n\t\t\t\t\tcolor: #333;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.device_box_text {\r\n\t\t\t\t\tmax-width: 460rpx;\r\n\t\t\t\t\tcolor: #555;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t\twhite-space: nowrap;\r\n\t\t\t\t\toverflow: hidden;\r\n\t\t\t\t\ttext-overflow: ellipsis;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</style>","import MiniProgramPage from 'F:/yunsoo_mobile/pages/workorder/workorder.vue'\nwx.createPage(MiniProgramPage)"],"names":["useToast","useMessage","userInfoStore","ref","reactive","onMounted","uni","nextTick","onPullDownRefresh","requestMethods","MiniProgramPage"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0GC,MAAM,aAAa,MAAW;;;;AAK9B,UAAM,QAAQA,kDAAAA,SAAU;AACxB,UAAM,UAAUC,uDAAAA,WAAY;AAE5B,UAAM,YAAYC,gBAAAA,cAAe;AAEjC,UAAM,SAASC,cAAG,IAAC,CAAC;AACpB,UAAM,YAAYA,cAAG,IAAC,IAAI;AAE1B,UAAM,oBAAoBA,cAAG,IAAC,EAAE;AACnBA,kBAAAA,IAAI,EAAE;AACnB,UAAM,UAAUC,cAAAA,SAAS,CAAC;AAAA,MACzB,IAAI;AAAA,MACJ,MAAM;AAAA,IACR,GAAI;AAAA,MACF,IAAI;AAAA,MACJ,MAAM;AAAA,IACR,GAAI;AAAA,MACF,IAAI;AAAA,MACJ,MAAM;AAAA,IACR,GAAI;AAAA,MACF,IAAI;AAAA,MACJ,MAAM;AAAA,IACR,CAAE,CAAC;AAEFC,kBAAAA,UAAU,MAAM;AAEfC,0BAAI,IAAI,eAAe,MAAM;AAC5B,yBAAiB,UAAU,QAAQ,OAAO,KAAK;AAAA,MAClD,CAAG;AACDC,oBAAAA,WAAS,MAAM;AACd,yBAAiB,UAAU,QAAQ,OAAO,KAAK;AAAA,MAClD,CAAG;AAAA,IACH,CAAE;AAEDC,kBAAAA,kBAAkB,MAAM;AACvB,uBAAiB,UAAU,QAAQ,OAAO,KAAK;AAAA,IACjD,CAAE;AAED,UAAM,yBAAyB,MAAM;AACpC,UAAG,CAAC,UAAU,OAAO;AACpB,yBAAiB,UAAU,QAAQ,OAAO,KAAK;AAAA,MAC/C;AAAA,IACD;AAED,UAAM,mBAAmB,OAAO,IAAI,QAAQ;AAC3C,UAAI,MAAM,MAAMC,+BAAe,iBAAiB,OAAO;AAAA,QACtD,QAAQ;AAAA,QACR,OAAO;AAAA,MACV,CAAG;AACD,UAAG,IAAI,SAAS,KAAK;AACpB,0BAAkB,QAAQ,IAAI,QAAQ,CAAE;AACxC,kBAAU,QAAQ;AAClBH,sBAAAA,MAAI,oBAAqB;AAAA,MAC5B,OAAQ;AACL,cAAM,MAAM,QAAQ;AACpB,kBAAU,QAAQ;AAClBA,sBAAAA,MAAI,oBAAqB;AAAA,MACzB;AAAA,IACD;AAGD,UAAM,uBAAuB,CAAC,OAAO;AACpCA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,mDAAmD,EAAE;AAAA,MAC7D,CAAG;AAAA,IACD;AAGD,UAAM,sBAAsB,CAAC,OAAO;AACnC,cAAQ,QAAQ;AAAA,QACf,OAAO;AAAA,QACP,KAAK;AAAA,MACR,CAAG,EACA,KAAK,YAAY;AACjB,YAAI,MAAM,MAAMG,+BAAe,oBAAoB,QAAQ;AAAA,UAC1D,OAAO;AAAA,QACX,CAAI;AACD,YAAG,IAAI,SAAS,KAAK;AACpB,gBAAM,KAAK;AAAA,YACV,KAAK;AAAA,YACL,UAAU;AAAA,YACV,UAAU;AAAA,YACV,QAAQ,MAAM;AACb,+BAAiB,UAAU,QAAQ,OAAO,KAAK;AAAA,YAC/C;AAAA,UACN,CAAK;AAAA,QACL,OAAS;AACL,gBAAM,MAAM,MAAM;AAAA,QAClB;AAAA,MACJ,CAAG,EACA,MAAM,MAAM;AAAA,MAEf,CAAG;AAAA,IACD;AAED,UAAM,sBAAsB,MAAM;AACjCH,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,MACR,CAAG;AAAA,IACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjNF,GAAG,WAAWI,SAAe;"}