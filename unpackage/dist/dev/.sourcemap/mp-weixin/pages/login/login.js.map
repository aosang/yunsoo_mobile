{"version":3,"file":"login.js","sources":["pages/login/login.vue","D:/software/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbG9naW4vbG9naW4udnVl"],"sourcesContent":["<template>\r\n\t<Navigation />\r\n\t<wd-toast />\r\n\t<view class=\"login\">\r\n\t\t<image src=\"/static/images/common/system_logo_white.png\" mode=\"widthFix\" />\r\n\t</view>\r\n\t\r\n\t<!-- form -->\r\n\t<view class=\"login_form\">\r\n\t\t<view class=\"login_form_item\">\r\n\t\t\t<view class=\"login_form_label\">电子邮箱</view>\r\n\t\t\t<wd-input \r\n\t\t\t\tcustom-input-class=\"commonInput\"\r\n\t\t\t\tplaceholder=\"请输入邮箱\"  \r\n\t\t\t\tv-model=\"loginFormText.email\"\r\n\t\t\t\tclearable\r\n\t\t\t/>\r\n\t\t</view>\r\n\t\t<view class=\"login_form_item\">\r\n\t\t\t<view class=\"login_form_label\">登录密码</view>\r\n\t\t\t<wd-input \r\n\t\t\t\tcustom-input-class=\"commonInput\"\r\n\t\t\t\tplaceholder=\"请输入密码\" \r\n\t\t\t\tv-model=\"loginFormText.password\"\r\n\t\t\t\tclearable\r\n\t\t\t\tshow-password\r\n\t\t\t/>\r\n\t\t</view>\r\n\t\t<wd-button \r\n\t\t\tsize=\"large\" \r\n\t\t\tcustom-class=\"custom-submit\" \r\n\t\t\t@click=\"handleCheckForm\"\r\n\t\t>\r\n\t\t\t立即登录\r\n\t\t</wd-button>\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\r\n\timport { reactive, ref, onMounted } from 'vue';\r\n\timport Navigation from '@/components/navigation_header.vue'\r\n\timport { useToast } from '@/uni_modules/wot-design-uni'\r\n\tconst toast = useToast()\r\n\timport { requestMethods } from '@/request/request'\r\n\timport { userInfoStore } from '@/stores/userInfo'\r\n\tconst userStore = userInfoStore()\r\n\t\r\n\tconst loginFormText = reactive({\r\n\t\temail: '',\r\n\t\tpassword: ''\r\n\t})\r\n\t\r\n\tconst isError = ref(false)\r\n\t\r\n\tconst handleCheckForm = async () => {\r\n\t\tlet emailReg = /^\\w{3,}(\\.\\w+)*@[A-z0-9]+(\\.[A-z]{2,5}){1,2}$/;\r\n\t\tif(!loginFormText.email || !emailReg.test(loginFormText.email)) {\r\n\t\t\ttoast.error('请输入正确邮箱')\r\n\t\t}else if(!loginFormText.password) {\r\n\t\t\ttoast.error('密码错误')\r\n\t\t} else {\r\n\t\t\tlet res = await requestMethods('/Login', 'POST', loginFormText)\r\n\t\t\tif(res.code === 200) {\r\n\t\t\t\ttoast.show({\r\n\t\t\t\t\ticonName: 'success',\r\n\t\t\t\t\tmsg: '登录成功',\r\n\t\t\t\t\tduration: 600,\r\n\t\t\t\t\tclosed: () => {\r\n\t\t\t\t\t\tlet { access_token, expires_at } = res.data.session\r\n\t\t\t\t\t\tlet { id } = res.data.session.user\r\n\t\t\t\t\t\tlet { username } = res.data.session.user.user_metadata\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tuserStore.setUser(access_token, expires_at, id, username)\r\n\t\t\t\t\t\tuni.reLaunch({\r\n\t\t\t\t\t\t\turl: '/pages/index/index'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}else if(res.code === 400) {\r\n\t\t\t\ttoast.error('邮箱或密码错误')\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\t.login {\r\n\t\twidth: 100%;\r\n\t\tbackground: #2a6fff;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\r\n\t\timage {\r\n\t\t\tdisplay: block;\r\n\t\t\twidth: 100%;\r\n\t\t\tmargin: 70rpx auto 0 auto;\r\n\t\t}\r\n\t}\r\n\t\r\n\t.login_form {\r\n\t\twidth: 660rpx;\r\n\t\tmargin: 60rpx auto 0 auto;\r\n\t\t\r\n\t\t:deep() {\r\n\t\t\t.custom-submit {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\tmargin-top: 30rpx;\r\n\t\t\t\tbackground: #2a6fff !important;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t.login_form_item {\r\n\t\t\tmargin-bottom: 30rpx;\r\n\t\t\t.login_form_label {\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tcolor: #333;\r\n\t\t\t\tmargin-bottom: 10rpx;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.commonInput {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\tbox-shadow: none;\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tborder-bottom: 1px solid #eee;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</style>","import MiniProgramPage from 'F:/yunsoo_mobile/pages/login/login.vue'\nwx.createPage(MiniProgramPage)"],"names":["useToast","userInfoStore","reactive","ref","requestMethods","uni","MiniProgramPage"],"mappings":";;;;;;;;;;;;;;;;;;;AAwCC,MAAM,aAAa,MAAW;;;;AAE9B,UAAM,QAAQA,kDAAAA,SAAU;AAGxB,UAAM,YAAYC,gBAAAA,cAAe;AAEjC,UAAM,gBAAgBC,cAAAA,SAAS;AAAA,MAC9B,OAAO;AAAA,MACP,UAAU;AAAA,IACZ,CAAE;AAEeC,kBAAAA,IAAI,KAAK;AAEzB,UAAM,kBAAkB,YAAY;AACnC,UAAI,WAAW;AACf,UAAG,CAAC,cAAc,SAAS,CAAC,SAAS,KAAK,cAAc,KAAK,GAAG;AAC/D,cAAM,MAAM,SAAS;AAAA,MACxB,WAAW,CAAC,cAAc,UAAU;AACjC,cAAM,MAAM,MAAM;AAAA,MACrB,OAAS;AACN,YAAI,MAAM,MAAMC,gBAAAA,eAAe,UAAU,QAAQ,aAAa;AAC9D,YAAG,IAAI,SAAS,KAAK;AACpB,gBAAM,KAAK;AAAA,YACV,UAAU;AAAA,YACV,KAAK;AAAA,YACL,UAAU;AAAA,YACV,QAAQ,MAAM;AACb,kBAAI,EAAE,cAAc,WAAY,IAAG,IAAI,KAAK;AAC5C,kBAAI,EAAE,GAAI,IAAG,IAAI,KAAK,QAAQ;AAC9B,kBAAI,EAAE,SAAQ,IAAK,IAAI,KAAK,QAAQ,KAAK;AAEzC,wBAAU,QAAQ,cAAc,YAAY,IAAI,QAAQ;AACxDC,4BAAAA,MAAI,SAAS;AAAA,gBACZ,KAAK;AAAA,cACZ,CAAO;AAAA,YACD;AAAA,UACN,CAAK;AAAA,QACL,WAAY,IAAI,SAAS,KAAK;AAC1B,gBAAM,MAAM,SAAS;AAAA,QACrB;AAAA,MACD;AAAA,IACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjFF,GAAG,WAAWC,SAAe;"}