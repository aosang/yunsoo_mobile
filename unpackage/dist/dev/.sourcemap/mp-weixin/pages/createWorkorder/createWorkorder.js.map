{"version":3,"file":"createWorkorder.js","sources":["pages/createWorkorder/createWorkorder.vue","D:/software/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY3JlYXRlV29ya29yZGVyL2NyZWF0ZVdvcmtvcmRlci52dWU"],"sourcesContent":["<template>\r\n\t<Navigation />\r\n\t<wd-toast />\r\n\t<view class=\"create_workorder\">\r\n\t\t<wd-navbar\r\n\t\t\ttitle=\"创建工单\" \r\n\t\t\tfixed \r\n\t\t\tcustom-class=\"custom\"\r\n\t\t\tleft-arrow\r\n\t\t\tleft-text=\"返回\"\r\n\t\t\tright-text=\"提交\"\r\n\t\t\tcustom-style=\"color: #fff\"\r\n\t\t\t@click-left=\"backToWorkorderList\"\r\n\t\t\t@click-right=\"createWorkorderSubmit\"\r\n\t\t>\r\n\t\t</wd-navbar>\r\n\t</view>\r\n\t\r\n\t<view class=\"workorder_form\">\r\n\t\t<wd-notice-bar \r\n\t\t\ttext=\"除备注信息外，其它均为必填项\" \r\n\t\t\tprefix=\"warn-bold\"\r\n\t\t\t:scrollable=\"false\"\r\n\t\t\tclass=\"notice-bar\"\r\n\t\t>\r\n\t\t</wd-notice-bar>\r\n\t\t<wd-divider class=\"workorder_name\">\r\n\t\t\t<view style=\"display: block;\">{{userStore.userName || '--'}}</view>\r\n\t\t</wd-divider>\r\n\t\t<view class=\"workorder_form_item\">\r\n\t\t\t<wd-select-picker\r\n\t\t\t\tlabel=\"选择设备\" \r\n\t\t\t\tv-model=\"workorderForm.created_product\" \r\n\t\t\t\t:columns=\"workorderDevice\"\r\n\t\t\t\t:z-index=\"1000\"\r\n\t\t\t\ttype=\"radio\" \r\n\t\t\t\tlabel-key=\"value\"\r\n\t\t\t\tvalue-key=\"value\"\r\n\t\t\t\tcustom-class=\"custom_select\"\r\n\t\t\t\tcustom-label-class=\"custom_label\"\r\n\t\t\t\tcustom-value-class=\"custom_value\"\r\n\t\t\t\tcustom-content-class=\"custom_content\"\r\n\t\t\t\tplaceholder=\"请选择设备\"\r\n\t\t\t\tclearable\r\n\t\t\t\t@confirm=\"confirmSelectDevice\"\r\n\t\t\t>\r\n\t\t\t</wd-select-picker>\r\n\t\t</view>\r\n\t\t<view class=\"workorder_form_item\" v-if=\"workorderForm.created_product\">\r\n\t\t\t<view class=\"workorder_form_time\">\r\n\t\t\t\t<view>设备类型</view>\r\n\t\t\t\t<view class=\"workorder_form_value\">{{ workorderForm.created_type }}</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"workorder_form_item\" v-if=\"workorderForm.created_product\">\r\n\t\t\t<view class=\"workorder_form_time\">\r\n\t\t\t\t<view>设备品牌</view>\r\n\t\t\t\t<view class=\"workorder_form_value\">{{ workorderForm.created_brand }}</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"workorder_form_item\">\r\n\t\t\t<wd-select-picker\r\n\t\t\t\tlabel=\"当前状态\" \r\n\t\t\t\tv-model=\"workorderForm.created_status\" \r\n\t\t\t\t:columns=\"workorderStatus\" \r\n\t\t\t\t:z-index=\"1000\"\r\n\t\t\t\ttype=\"radio\" \r\n\t\t\t\tlabel-key=\"value\"\r\n\t\t\t\tvalue-key=\"value\"\r\n\t\t\t\tcustom-class=\"custom_select\"\r\n\t\t\t\tcustom-label-class=\"custom_label\"\r\n\t\t\t\tcustom-value-class=\"custom_value\"\r\n\t\t\t\tcustom-content-class=\"custom_content\"\r\n\t\t\t\tplaceholder=\"请选择当前状态\"\r\n\t\t\t\tclearable\r\n\t\t\t\t@confirm=\"confirmSelectStatus\"\r\n\t\t\t>\r\n\t\t\t</wd-select-picker>\r\n\t\t</view>\r\n\t\t<view class=\"workorder_form_item\">\r\n\t\t\t<view class=\"workorder_form_time\">\r\n\t\t\t\t<view>创建时间</view>\r\n\t\t\t\t<view class=\"workorder_form_value\">{{ workorderForm.created_time }}</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"workorder_form_item\">\r\n\t\t\t<view class=\"workorder_form_time\">\r\n\t\t\t\t<view>更新时间</view>\r\n\t\t\t\t<view class=\"workorder_form_value\">{{ workorderForm.created_update }}</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n\t<!-- 问题描述 -->\r\n\t<view class=\"created_textarea\">\r\n\t\t<view class=\"created_textarea_label\">问题描述</view>\r\n\t\t<wd-textarea\r\n\t\t\t:adjust-position=\"false\"\r\n\t\t\t:maxlength=\"260\"\r\n\t\t\tv-model=\"workorderForm.created_text\"\r\n\t\t\tplaceholder=\"填写问题描述\"\r\n\t\t\tcustom-textarea-class=\"custom-desc\"\r\n\t\t\tclearable \r\n\t\t\tshow-word-limit\r\n\t\t/>\r\n\t</view>\r\n\t<!-- 解决方案 -->\r\n\t<view class=\"created_textarea\" v-if=\"workorderForm.created_status === '已解决'\">\r\n\t\t<view class=\"created_textarea_label\">解决方案</view>\r\n\t\t<wd-textarea\r\n\t\t\t:adjust-position=\"false\"\r\n\t\t\t:maxlength=\"260\"\r\n\t\t\tv-model=\"workorderForm.created_solved\"\r\n\t\t\tplaceholder=\"填写解决方案\"\r\n\t\t\tcustom-textarea-class=\"custom-desc\"\r\n\t\t\tclearable \r\n\t\t\tshow-word-limit\r\n\t\t/>\r\n\t</view>\r\n\t<!-- 备注 -->\r\n\t<view class=\"created_textarea\">\r\n\t\t<view class=\"created_textarea_label\">备注信息</view>\r\n\t\t<wd-textarea\r\n\t\t\t:adjust-position=\"false\"\r\n\t\t\t:maxlength=\"120\"\r\n\t\t\tv-model=\"workorderForm.created_remark\"\r\n\t\t\tplaceholder=\"填写备注\"\r\n\t\t\tcustom-textarea-class=\"custom-desc\"\r\n\t\t\tclearable \r\n\t\t\tshow-word-limit\r\n\t\t/>\r\n\t</view>\r\n\t<view \r\n\t\tclass=\"whiteBox\" \r\n\t\tstyle=\"height: 500rpx;\"\r\n\t>\r\n\t</view>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\n\timport Navigation from '@/components/navigation_header.vue'\r\n\timport { useToast } from '@/uni_modules/wot-design-uni'\r\n\tconst toast = useToast()\r\n\timport { ref, onMounted, nextTick, reactive } from 'vue'\r\n\timport { requestMethods } from '@/request/request'\r\n\timport { workOrderFormProps } from '@/utils/dataType.js'\r\n\timport { userInfoStore } from \"@/stores/userInfo\"\r\n\tconst userStore = userInfoStore()\r\n\timport dayjs from 'dayjs'\r\n\timport { formatTime, getTimenumber } from '@/request/formatTime'\r\n\t\r\n\tonMounted(() => {\r\n\t\tworkorderForm.id = userStore.userId\r\n\t\tworkorderForm.created_name = userStore.userName\r\n\t\tworkorderForm.created_time = formatTime()\r\n\t\tworkorderForm.created_update = formatTime()\r\n\t\tworkorderForm.created_id = getTimenumber()[0]\r\n\t\t\t\r\n\t\tnextTick(() => {\r\n\t\t\tgetWorkorderDevice()\r\n\t\t\tgetWorkorderStatus()\r\n\t\t})\r\n\t})\r\n\t\r\n\tconst backToWorkorderList = () => {\r\n\t\tuni.navigateBack()\r\n\t}\r\n\t\r\n\tconst createWorkorderSubmit = () => {\r\n\t\tconst {created_product, created_solved, created_status, created_text} = workorderForm\r\n\t\tif(!created_product || !created_status || !created_text) {\r\n\t\t\ttoast.error('请填写完整信息')\r\n\t\t}else if(created_status === '已解决' && !created_solved) {\r\n\t\t\ttoast.error('请填写完整信息')\r\n\t\t}\r\n\t\telse {\r\n\t\t\taddWorkorderform()\r\n\t\t}\r\n\t}\r\n\t\r\n\tconst workorderForm = reactive<workOrderFormProps>({\r\n\t\tid: '',\r\n\t\tcreated_id: '',\r\n\t\tcreated_product:'',\r\n\t\tcreated_name: '',\r\n\t\tcreated_time: '',\r\n\t\tcreated_update: '',\r\n\t\tcreated_solved: '',\r\n\t\tcreated_type: '',\r\n\t\tcreated_brand: '',\r\n\t\tcreated_status:'',\r\n\t\tcreated_text:'',\r\n\t\tcreated_remark:''\r\n\t})\r\n\tconst workorderDevice = ref<Record<string, any>>([])\r\n\tconst workorderStatus = ref<Record<string, any>>([])\r\n\tconst device = ref<string>('')\r\n\tconst createTime = ref<string>('2025-07-25 16:35')\r\n\tconst isScroll = ref<boolean>(false)\r\n\t\r\n\tconst confirmSelectDevice = (event: any) => {\r\n\t\tworkorderForm.created_product = event.selectedItems.product_name\r\n\t\tworkorderForm.created_type = event.selectedItems.product_type\r\n\t\tworkorderForm.created_brand = event.selectedItems.product_brand\r\n\t}\r\n\t\r\n\tconst confirmSelectStatus = (event: any) => {\r\n\t\tworkorderForm.created_status = event.value\r\n\t}\r\n\t\r\n\tconst getWorkorderDevice = async () => {\r\n\t\tlet res = await requestMethods('/GetDevice', 'GET')\r\n\t\tworkorderDevice.value = res.data\r\n\t}\r\n\t\r\n\tconst getWorkorderStatus = async () => {\r\n\t\tlet res = await requestMethods('/GetStatus', 'GET')\r\n\t\tworkorderStatus.value = res.data\r\n\t}\r\n\t\r\n\t// 新增工单\r\n\tconst addWorkorderform = async () => {\r\n\t\tlet res = await requestMethods('/AddWorkorder', 'POST', workorderForm)\r\n\t\tif(res.code === 200) {\r\n\t\t\ttoast.show({\r\n\t\t\t\ticonName: 'success',\r\n\t\t\t\tmsg: '新增工单成功',\r\n\t\t\t\tduration: 800,\r\n\t\t\t\tclosed: () => {\r\n\t\t\t\t\tuni.switchTab({\r\n\t\t\t\t\t\turl: '/pages/workorder/workorder' \r\n\t\t\t\t\t})\r\n\t\t\t\t\tuni.$emit('refreshData')\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}else {\r\n\t\t\ttoast.error('新增工单失败')\r\n\t\t\tuni.__f__('log','at pages/createWorkorder/createWorkorder.vue:237',res)\r\n\t\t}\r\n\t}\r\n\r\n</script>\r\n\r\n<style lang=\"scss\" >\r\nhtml, body {\r\n\theight: 100vh;\r\n\tbackground: #f3f3f3;\r\n}\r\n\r\n.create_workorder {\r\n\twidth: 100%;\r\n\t:deep() {\r\n\t\t.custom {\r\n\t\t\tbackground-color: #2a6fff;\r\n\t\t\tmargin-top: 88rpx;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n.workorder_form {\r\n\tbackground: #fff;\r\n\tpadding-top: 190rpx;\r\n\t\r\n\t.notice-bar {\r\n\t\tfont-size: 28rpx;\r\n\t}\r\n\t\r\n\t:deep() {\r\n\t\t.custom_label {\r\n\t\t\tfont-size: 28rpx;\r\n\t\t\tmargin-top: 4rpx;\r\n\t\t}\r\n\t\t.custom_value {\r\n\t\t\tfont-size: 28rpx;\r\n\t\t\tmargin-top: 4rpx;\r\n\t\t}\r\n\t\t.custom_select {\r\n\t\t\theight: 90rpx;\r\n\t\t\tborder-bottom: 1px solid #eee;\r\n\t\t}\r\n\t}\r\n\t\r\n\t.workorder_name {\r\n\t\tfont-size: 32rpx;\r\n\t\tfont-weight: 600;\r\n\t\tcolor: #2a6fff;\r\n\t}\r\n\t\r\n\t.workorder_form_time {\r\n\t\theight: 90rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #333;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tpadding: 0 30rpx;\r\n\t\tborder-bottom: 1px solid #eee;\r\n\t\t\r\n\t\t.workorder_form_value {\r\n\t\t\tmargin-left: 138rpx;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n.created_textarea {\r\n\tmargin-top: 24rpx;\r\n\tbackground: #fff;\r\n\t\r\n\t.created_textarea_label {\r\n\t\tpadding: 28rpx 28rpx 0 28rpx;\r\n\t\tcolor: #333;\r\n\t\tfont-size: 28rpx;\r\n\t}\r\n\t:deep() {\r\n\t\t.custom-desc {\r\n\t\t\tmax-height: 140rpx;\r\n\t\t\tbox-sizing: border-box;\r\n\t\t\tfont-size: 28rpx;\r\n\t\t}\r\n\t}\r\n}\r\n</style>\r\n","import MiniProgramPage from 'F:/yunsoo_mobile/pages/createWorkorder/createWorkorder.vue'\nwx.createPage(MiniProgramPage)"],"names":["useToast","userInfoStore","onMounted","formatTime","getTimenumber","nextTick","uni","reactive","ref","requestMethods","MiniProgramPage"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AA2IC,MAAA,aAAuB,MAAA;;;;AAEvB,UAAM,QAAQA,kDAAAA;AAKd,UAAM,YAAYC,gBAAAA;AAIlBC,kBAAAA,UAAU,MAAM;AACf,oBAAc,KAAK,UAAU;AAC7B,oBAAc,eAAe,UAAU;AACvC,oBAAc,eAAeC,mBAAAA;AAC7B,oBAAc,iBAAiBA,mBAAAA;AACjB,oBAAA,aAAaC,iCAAc,EAAE,CAAC;AAE5CC,oBAAAA,WAAS,MAAM;AACK;AACA;MAAA,CACnB;AAAA,IAAA,CACD;AAED,UAAM,sBAAsB,MAAM;AACjCC,oBAAA,MAAI,aAAa;AAAA,IAAA;AAGlB,UAAM,wBAAwB,MAAM;AACnC,YAAM,EAAC,iBAAiB,gBAAgB,gBAAgB,iBAAgB;AACxE,UAAG,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,cAAc;AACxD,cAAM,MAAM,SAAS;AAAA,MACb,WAAA,mBAAmB,SAAS,CAAC,gBAAgB;AACrD,cAAM,MAAM,SAAS;AAAA,MAAA,OAEjB;AACa;MAClB;AAAA,IAAA;AAGD,UAAM,gBAAgBC,cAAAA,SAA6B;AAAA,MAClD,IAAI;AAAA,MACJ,YAAY;AAAA,MACZ,iBAAgB;AAAA,MAChB,cAAc;AAAA,MACd,cAAc;AAAA,MACd,gBAAgB;AAAA,MAChB,gBAAgB;AAAA,MAChB,cAAc;AAAA,MACd,eAAe;AAAA,MACf,gBAAe;AAAA,MACf,cAAa;AAAA,MACb,gBAAe;AAAA,IAAA,CACf;AACK,UAAA,kBAAkBC,kBAAyB,CAAA,CAAE;AAC7C,UAAA,kBAAkBA,kBAAyB,CAAA,CAAE;AACpCA,kBAAAA,IAAY,EAAE;AACVA,kBAAAA,IAAY,kBAAkB;AAChCA,kBAAAA,IAAa,KAAK;AAE7B,UAAA,sBAAsB,CAAC,UAAe;AAC7B,oBAAA,kBAAkB,MAAM,cAAc;AACtC,oBAAA,eAAe,MAAM,cAAc;AACnC,oBAAA,gBAAgB,MAAM,cAAc;AAAA,IAAA;AAG7C,UAAA,sBAAsB,CAAC,UAAe;AAC3C,oBAAc,iBAAiB,MAAM;AAAA,IAAA;AAGtC,UAAM,qBAAqB,YAAY;AACtC,UAAI,MAAM,MAAMC,gBAAAA,eAAe,cAAc,KAAK;AAClD,sBAAgB,QAAQ,IAAI;AAAA,IAAA;AAG7B,UAAM,qBAAqB,YAAY;AACtC,UAAI,MAAM,MAAMA,gBAAAA,eAAe,cAAc,KAAK;AAClD,sBAAgB,QAAQ,IAAI;AAAA,IAAA;AAI7B,UAAM,mBAAmB,YAAY;AACpC,UAAI,MAAM,MAAMA,gBAAe,eAAA,iBAAiB,QAAQ,aAAa;AAClE,UAAA,IAAI,SAAS,KAAK;AACpB,cAAM,KAAK;AAAA,UACV,UAAU;AAAA,UACV,KAAK;AAAA,UACL,UAAU;AAAA,UACV,QAAQ,MAAM;AACbH,0BAAAA,MAAI,UAAU;AAAA,cACb,KAAK;AAAA,YAAA,CACL;AACDA,gCAAI,MAAM,aAAa;AAAA,UACxB;AAAA,QAAA,CACA;AAAA,MAAA,OACI;AACL,cAAM,MAAM,QAAQ;AAChBA,sBAAAA,MAAA,MAAM,OAAM,oDAAmD,GAAG;AAAA,MACvE;AAAA,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5OF,GAAG,WAAWI,SAAe;"}