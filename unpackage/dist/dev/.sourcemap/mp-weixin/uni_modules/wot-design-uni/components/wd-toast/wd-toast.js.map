{"version":3,"file":"wd-toast.js","sources":["uni_modules/wot-design-uni/components/wd-toast/wd-toast.vue","D:/software/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RjoveXVuc29vX21vYmlsZS91bmlfbW9kdWxlcy93b3QtZGVzaWduLXVuaS9jb21wb25lbnRzL3dkLXRvYXN0L3dkLXRvYXN0LnZ1ZQ"],"sourcesContent":["<template>\r\n  <wd-overlay v-if=\"cover\" :z-index=\"zIndex\" lock-scroll :show=\"show\" custom-style=\"background-color: transparent;pointer-events: auto;\"></wd-overlay>\r\n  <wd-transition name=\"fade\" :show=\"show\" :custom-style=\"transitionStyle\" @after-enter=\"handleAfterEnter\" @after-leave=\"handleAfterLeave\">\r\n    <view :class=\"rootClass\">\r\n      <!--iconName优先级更高-->\r\n      <wd-loading\r\n        v-if=\"iconName === 'loading'\"\r\n        :type=\"loadingType\"\r\n        :color=\"loadingColor\"\r\n        :size=\"loadingSize\"\r\n        :custom-class=\"`wd-toast__icon ${direction === 'vertical' ? 'is-vertical' : ''}`\"\r\n      />\r\n      <view\r\n        :class=\"`wd-toast__iconWrap wd-toast__icon ${direction === 'vertical' ? 'is-vertical' : ''}`\"\r\n        v-else-if=\"iconName === 'success' || iconName === 'warning' || iconName === 'info' || iconName === 'error'\"\r\n      >\r\n        <view class=\"wd-toast__iconBox\">\r\n          <view class=\"wd-toast__iconSvg\" :style=\"svgStyle\"></view>\r\n        </view>\r\n      </view>\r\n      <wd-icon\r\n        v-else-if=\"iconClass\"\r\n        :custom-class=\"`wd-toast__icon ${direction === 'vertical' ? 'is-vertical' : ''}`\"\r\n        :size=\"iconSize\"\r\n        :class-prefix=\"classPrefix\"\r\n        :name=\"iconClass\"\r\n      ></wd-icon>\r\n      <!--文本-->\r\n      <view v-if=\"msg\" class=\"wd-toast__msg\">{{ msg }}</view>\r\n    </view>\r\n  </wd-transition>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nexport default {\r\n  name: 'wd-toast',\r\n  options: {\r\n    addGlobalClass: true,\r\n    virtualHost: true,\r\n    styleIsolation: 'shared'\r\n  }\r\n}\r\n</script>\r\n\r\n<script lang=\"ts\" setup>\r\nimport wdIcon from '../wd-icon/wd-icon.vue'\r\nimport wdLoading from '../wd-loading/wd-loading.vue'\r\nimport wdOverlay from '../wd-overlay/wd-overlay.vue'\r\nimport wdTransition from '../wd-transition/wd-transition.vue'\r\n\r\nimport { computed, inject, onBeforeMount, ref, watch, type CSSProperties } from 'vue'\r\nimport base64 from '../common/base64'\r\nimport { defaultOptions, getToastOptionKey, toastIcon } from '.'\r\nimport { toastProps, type ToastDirection, type ToastLoadingType, type ToastOptions, type ToastProps } from './types'\r\nimport { addUnit, isDef, isFunction, objToStyle } from '../common/util'\r\n\r\nconst props = defineProps(toastProps)\r\nconst iconName = ref<string>('') // 图标类型\r\nconst msg = ref<string>('') // 消息内容\r\nconst position = ref<string>('middle')\r\nconst show = ref<boolean>(false)\r\nconst zIndex = ref<number>(100)\r\nconst loadingType = ref<ToastLoadingType>('outline')\r\nconst loadingColor = ref<string>('#4D80F0')\r\nconst iconSize = ref<string>() // 图标大小\r\nconst loadingSize = ref<string>() // loading大小\r\nconst svgStr = ref<string>('') // 图标\r\nconst cover = ref<boolean>(false) // 是否存在遮罩层\r\nconst classPrefix = ref<string>('wd-icon') // 图标前缀\r\nconst iconClass = ref<string>('') // 图标类名\r\nconst direction = ref<ToastDirection>('horizontal') // toast布局方向\r\n\r\nlet opened: (() => void) | null = null\r\n\r\nlet closed: (() => void) | null = null\r\n\r\nconst toastOptionKey = getToastOptionKey(props.selector)\r\nconst toastOption = inject(toastOptionKey, ref<ToastOptions>(defaultOptions)) // toast选项\r\n\r\n// 监听options变化展示\r\nwatch(\r\n  () => toastOption.value,\r\n  (newVal: ToastOptions) => {\r\n    reset(newVal)\r\n  },\r\n  {\r\n    deep: true,\r\n    immediate: true\r\n  }\r\n)\r\n\r\n// 监听options变化展示\r\nwatch(\r\n  () => iconName.value,\r\n  () => {\r\n    buildSvg()\r\n  },\r\n  {\r\n    deep: true,\r\n    immediate: true\r\n  }\r\n)\r\n\r\n/**\r\n * 动画自定义样式\r\n */\r\nconst transitionStyle = computed(() => {\r\n  const style: CSSProperties = {\r\n    'z-index': zIndex.value,\r\n    position: 'fixed',\r\n    top: '50%',\r\n    left: 0,\r\n    width: '100%',\r\n    transform: 'translate(0, -50%)',\r\n    'text-align': 'center',\r\n    'pointer-events': 'none'\r\n  }\r\n  return objToStyle(style)\r\n})\r\n\r\nconst rootClass = computed(() => {\r\n  return `wd-toast ${props.customClass} wd-toast--${position.value} ${\r\n    (iconName.value !== 'loading' || msg.value) && (iconName.value || iconClass.value) ? 'wd-toast--with-icon' : ''\r\n  } ${iconName.value === 'loading' && !msg.value ? 'wd-toast--loading' : ''} ${direction.value === 'vertical' ? 'is-vertical' : ''}`\r\n})\r\n\r\nconst svgStyle = computed(() => {\r\n  const style: CSSProperties = {\r\n    backgroundImage: `url(${svgStr.value})`\r\n  }\r\n  if (isDef(iconSize.value)) {\r\n    style.width = iconSize.value\r\n    style.height = iconSize.value\r\n  }\r\n  return objToStyle(style)\r\n})\r\n\r\nonBeforeMount(() => {\r\n  buildSvg()\r\n})\r\n\r\nfunction handleAfterEnter() {\r\n  if (isFunction(opened)) {\r\n    opened()\r\n  }\r\n}\r\n\r\nfunction handleAfterLeave() {\r\n  if (isFunction(closed)) {\r\n    closed()\r\n  }\r\n}\r\n\r\nfunction buildSvg() {\r\n  if (iconName.value !== 'success' && iconName.value !== 'warning' && iconName.value !== 'info' && iconName.value !== 'error') return\r\n  const iconSvg = toastIcon[iconName.value]()\r\n  const iconSvgStr = `\"data:image/svg+xml;base64,${base64(iconSvg)}\"`\r\n  svgStr.value = iconSvgStr\r\n}\r\n\r\n/**\r\n * 重置toast选项值\r\n * @param option toast选项值\r\n */\r\nfunction reset(option: ToastOptions) {\r\n  show.value = isDef(option.show) ? option.show : false\r\n\r\n  if (show.value) {\r\n    mergeOptionsWithProps(option, props)\r\n  }\r\n}\r\n\r\nfunction mergeOptionsWithProps(option: ToastOptions, props: ToastProps) {\r\n  iconName.value = isDef(option.iconName!) ? option.iconName! : props.iconName\r\n  iconClass.value = isDef(option.iconClass!) ? option.iconClass! : props.iconClass\r\n  msg.value = isDef(option.msg!) ? option.msg! : props.msg\r\n  position.value = isDef(option.position!) ? option.position! : props.position\r\n  zIndex.value = isDef(option.zIndex!) ? option.zIndex! : props.zIndex\r\n  loadingType.value = isDef(option.loadingType!) ? option.loadingType! : props.loadingType\r\n  loadingColor.value = isDef(option.loadingColor!) ? option.loadingColor! : props.loadingColor\r\n  iconSize.value = isDef(option.iconSize) ? addUnit(option.iconSize) : isDef(props.iconSize) ? addUnit(props.iconSize) : undefined\r\n  loadingSize.value = isDef(option.loadingSize) ? addUnit(option.loadingSize) : isDef(props.loadingSize) ? addUnit(props.loadingSize) : undefined\r\n  cover.value = isDef(option.cover!) ? option.cover! : props.cover\r\n  classPrefix.value = isDef(option.classPrefix) ? option.classPrefix : props.classPrefix\r\n  direction.value = isDef(option.direction) ? option.direction : props.direction\r\n  closed = isFunction(option.closed) ? option.closed : isFunction(props.closed) ? props.closed : null\r\n  opened = isFunction(option.opened) ? option.opened : isFunction(props.opened) ? props.opened : null\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n@import './index.scss';\r\n</style>\r\n","import Component from 'F:/yunsoo_mobile/uni_modules/wot-design-uni/components/wd-toast/wd-toast.vue'\nwx.createComponent(Component)"],"names":["ref","getToastOptionKey","inject","defaultOptions","watch","computed","objToStyle","isDef","onBeforeMount","isFunction","toastIcon","base64","props","addUnit"],"mappings":"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"}