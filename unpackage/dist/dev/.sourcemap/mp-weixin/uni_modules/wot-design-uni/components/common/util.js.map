{"version":3,"file":"util.js","sources":["uni_modules/wot-design-uni/components/common/util.ts"],"sourcesContent":["import { AbortablePromise } from './AbortablePromise'\r\n\r\ntype NotUndefined<T> = T extends undefined ? never : T\r\n\r\n/**\r\n * 生成uuid\r\n * @returns string\r\n */\r\nexport function uuid() {\r\n  return s4() + s4() + s4() + s4() + s4() + s4() + s4() + s4()\r\n}\r\n\r\nfunction s4() {\r\n  return Math.floor((1 + Math.random()) * 0x10000)\r\n    .toString(16)\r\n    .substring(1)\r\n}\r\n\r\n/**\r\n * @description 对num自动填充px\r\n * @param {Number} num\r\n * @return {string} num+px\r\n */\r\nexport function addUnit(num: number | string) {\r\n  return Number.isNaN(Number(num)) ? `${num}` : `${num}px`\r\n}\r\n\r\n/**\r\n * @description 判断target是否对象\r\n * @param value\r\n * @return {boolean}\r\n */\r\nexport function isObj(value: any): value is object {\r\n  return Object.prototype.toString.call(value) === '[object Object]' || typeof value === 'object'\r\n}\r\n\r\n/**\r\n * 获取目标原始类型\r\n * @param target 任意类型\r\n * @returns {string} type 数据类型\r\n */\r\nexport function getType(target: unknown): string {\r\n  // 得到原生类型\r\n  const typeStr = Object.prototype.toString.call(target)\r\n  // 拿到类型值\r\n  const match = typeStr.match(/\\[object (\\w+)\\]/)\r\n  const type = match && match.length ? match[1].toLowerCase() : ''\r\n  // 类型值转小写并返回\r\n  return type\r\n}\r\n\r\n/**\r\n * @description 默认的外部格式化函数 - picker 组件\r\n * @param items - 要格式化的数据项数组或单个数据项\r\n * @param kv - 配置对象，包含 labelKey 作为键值\r\n * @returns 格式化后的字符串\r\n */\r\nexport const defaultDisplayFormat = function (items: any[] | Record<string, any>, kv?: { labelKey?: string }): string {\r\n  const labelKey: string = kv?.labelKey || 'value'\r\n\r\n  if (Array.isArray(items)) {\r\n    return items.map((item) => item[labelKey]).join(', ')\r\n  } else {\r\n    return items[labelKey]\r\n  }\r\n}\r\n\r\n/**\r\n * @description 默认函数占位符 - pickerView组件\r\n * @param value 值\r\n * @return value\r\n */\r\nexport const defaultFunction = <T>(value: T): T => value\r\n\r\n/**\r\n * @description 检查值是否不为空\r\n * @param value 值\r\n * @return {Boolean} 是否不为空\r\n */\r\nexport const isDef = <T>(value: T): value is NonNullable<T> => value !== undefined && value !== null\r\n\r\n/**\r\n * @description 防止数字小于零\r\n * @param {number} num\r\n * @param {string} label 标签\r\n */\r\nexport const checkNumRange = (num: number, label: string = 'value'): void => {\r\n  if (num < 0) {\r\n    throw new Error(`${label} shouldn't be less than zero`)\r\n  }\r\n}\r\n\r\n/**\r\n * @description 防止 pixel 无意义\r\n * @param {number} num\r\n * @param {string} label 标签\r\n */\r\nexport const checkPixelRange = (num: number, label: string = 'value'): void => {\r\n  if (num <= 0) {\r\n    throw new Error(`${label} should be greater than zero`)\r\n  }\r\n}\r\n\r\n/**\r\n * 将 RGB 值转换为十六进制颜色代码。\r\n * @param {number} r - 红色分量 (0-255)。\r\n * @param {number} g - 绿色分量 (0-255)。\r\n * @param {number} b - 蓝色分量 (0-255)。\r\n * @returns {string} 十六进制颜色代码 (#RRGGBB)。\r\n */\r\nexport function rgbToHex(r: number, g: number, b: number): string {\r\n  // 将 RGB 分量组合成一个十六进制数。\r\n  const hex = ((r << 16) | (g << 8) | b).toString(16)\r\n\r\n  // 使用零填充十六进制数，确保它有 6 位数字（RGB 范围）。\r\n  const paddedHex = '#' + '0'.repeat(Math.max(0, 6 - hex.length)) + hex\r\n\r\n  return paddedHex\r\n}\r\n\r\n/**\r\n * 将十六进制颜色代码转换为 RGB 颜色数组。\r\n * @param hex 十六进制颜色代码（例如：'#RRGGBB'）\r\n * @returns 包含红、绿、蓝三个颜色分量的数组\r\n */\r\nexport function hexToRgb(hex: string): number[] {\r\n  const rgb: number[] = []\r\n\r\n  // 从第一个字符开始，每两个字符代表一个颜色分量\r\n  for (let i = 1; i < 7; i += 2) {\r\n    // 将两个字符的十六进制转换为十进制，并添加到 rgb 数组中\r\n    rgb.push(parseInt('0x' + hex.slice(i, i + 2), 16))\r\n  }\r\n\r\n  return rgb\r\n}\r\n\r\n/**\r\n * 计算渐变色的中间变量数组。\r\n * @param {string} startColor 开始颜色\r\n * @param {string} endColor 结束颜色\r\n * @param {number} step 获取渲染位置，默认为中间位置\r\n * @returns {string[]} 渐变色中间颜色变量数组\r\n */\r\nexport const gradient = (startColor: string, endColor: string, step: number = 2): string[] => {\r\n  // 将hex转换为rgb\r\n  const sColor: number[] = hexToRgb(startColor)\r\n  const eColor: number[] = hexToRgb(endColor)\r\n\r\n  // 计算R\\G\\B每一步的差值\r\n  const rStep: number = (eColor[0] - sColor[0]) / step\r\n  const gStep: number = (eColor[1] - sColor[1]) / step\r\n  const bStep: number = (eColor[2] - sColor[2]) / step\r\n\r\n  const gradientColorArr: string[] = []\r\n  for (let i = 0; i < step; i++) {\r\n    // 计算每一步的hex值\r\n    gradientColorArr.push(\r\n      rgbToHex(parseInt(String(rStep * i + sColor[0])), parseInt(String(gStep * i + sColor[1])), parseInt(String(bStep * i + sColor[2])))\r\n    )\r\n  }\r\n  return gradientColorArr\r\n}\r\n\r\n/**\r\n * 确保数值不超出指定范围。\r\n * @param {number} num 要限制范围的数值\r\n * @param {number} min 最小范围\r\n * @param {number} max 最大范围\r\n * @returns {number} 在指定范围内的数值\r\n */\r\nexport const range = (num: number, min: number, max: number): number => {\r\n  // 使用 Math.min 和 Math.max 保证 num 不会超出指定范围\r\n  return Math.min(Math.max(num, min), max)\r\n}\r\n\r\n/**\r\n * 比较两个值是否相等。\r\n * @param {any} value1 第一个值\r\n * @param {any} value2 第二个值\r\n * @returns {boolean} 如果值相等则为 true，否则为 false\r\n */\r\nexport const isEqual = (value1: any, value2: any): boolean => {\r\n  // 使用严格相等运算符比较值是否相等\r\n  if (value1 === value2) {\r\n    return true\r\n  }\r\n\r\n  // 如果其中一个值不是数组，则认为值不相等\r\n  if (!Array.isArray(value1) || !Array.isArray(value2)) {\r\n    return false\r\n  }\r\n\r\n  // 如果数组长度不相等，则认为值不相等\r\n  if (value1.length !== value2.length) {\r\n    return false\r\n  }\r\n\r\n  // 逐个比较数组元素是否相等\r\n  for (let i = 0; i < value1.length; ++i) {\r\n    if (value1[i] !== value2[i]) {\r\n      return false\r\n    }\r\n  }\r\n\r\n  // 所有比较均通过，则认为值相等\r\n  return true\r\n}\r\n\r\n/**\r\n * 在数字前补零，使其达到指定长度。\r\n * @param {number | string} number 要补零的数字\r\n * @param {number} length 目标长度，默认为 2\r\n * @returns {string} 补零后的结果\r\n */\r\nexport const padZero = (number: number | string, length: number = 2): string => {\r\n  // 将输入转换为字符串\r\n  let numStr: string = number.toString()\r\n\r\n  // 在数字前补零，直到达到指定长度\r\n  while (numStr.length < length) {\r\n    numStr = '0' + numStr\r\n  }\r\n\r\n  return numStr\r\n}\r\n\r\n/** @description 全局变量id */\r\nexport const context = {\r\n  id: 1000\r\n}\r\n\r\nexport type RectResultType<T extends boolean> = T extends true ? UniApp.NodeInfo[] : UniApp.NodeInfo\r\n\r\n/**\r\n * 获取节点信息\r\n * @param selector 节点选择器 #id,.class\r\n * @param all 是否返回所有 selector 对应的节点\r\n * @param scope 作用域（支付宝小程序无效）\r\n * @param useFields 是否使用 fields 方法获取节点信息\r\n * @returns 节点信息或节点信息数组\r\n */\r\nexport function getRect<T extends boolean>(selector: string, all: T, scope?: any, useFields?: boolean): Promise<RectResultType<T>> {\r\n  return new Promise<RectResultType<T>>((resolve, reject) => {\r\n    let query: UniNamespace.SelectorQuery | null = null\r\n    if (scope) {\r\n      query = uni.createSelectorQuery().in(scope)\r\n    } else {\r\n      query = uni.createSelectorQuery()\r\n    }\r\n\r\n    const method = all ? 'selectAll' : 'select'\r\n\r\n    const callback = (rect: UniApp.NodeInfo | UniApp.NodeInfo[]) => {\r\n      if (all && isArray(rect) && rect.length > 0) {\r\n        resolve(rect as RectResultType<T>)\r\n      } else if (!all && rect) {\r\n        resolve(rect as RectResultType<T>)\r\n      } else {\r\n        reject(new Error('No nodes found'))\r\n      }\r\n    }\r\n\r\n    if (useFields) {\r\n      query[method](selector).fields({ size: true, node: true }, callback).exec()\r\n    } else {\r\n      query[method](selector).boundingClientRect(callback).exec()\r\n    }\r\n  })\r\n}\r\n\r\n/**\r\n * 将驼峰命名转换为短横线命名。\r\n * @param {string} word 待转换的词条\r\n * @returns {string} 转换后的结果\r\n */\r\nexport function kebabCase(word: string): string {\r\n  // 使用正则表达式匹配所有大写字母，并在前面加上短横线，然后转换为小写\r\n  const newWord: string = word\r\n    .replace(/[A-Z]/g, function (match) {\r\n      return '-' + match\r\n    })\r\n    .toLowerCase()\r\n\r\n  return newWord\r\n}\r\n\r\n/**\r\n * 将短横线链接转换为驼峰命名\r\n * @param word 需要转换的短横线链接\r\n * @returns 转换后的驼峰命名字符串\r\n */\r\nexport function camelCase(word: string): string {\r\n  return word.replace(/-(\\w)/g, (_, c) => c.toUpperCase())\r\n}\r\n\r\n/**\r\n * 检查给定值是否为数组。\r\n * @param {any} value 要检查的值\r\n * @returns {boolean} 如果是数组则返回 true，否则返回 false\r\n */\r\nexport function isArray(value: any): value is Array<any> {\r\n  // 如果 Array.isArray 函数可用，直接使用该函数检查\r\n  if (typeof Array.isArray === 'function') {\r\n    return Array.isArray(value)\r\n  }\r\n  // 否则，使用对象原型的 toString 方法进行检查\r\n  return Object.prototype.toString.call(value) === '[object Array]'\r\n}\r\n\r\n/**\r\n * 检查给定值是否为函数。\r\n * @param {any} value 要检查的值\r\n * @returns {boolean} 如果是函数则返回 true，否则返回 false\r\n */\r\n// eslint-disable-next-line @typescript-eslint/ban-types\r\nexport function isFunction<T extends Function>(value: any): value is T {\r\n  return getType(value) === 'function' || getType(value) === 'asyncfunction'\r\n}\r\n\r\n/**\r\n * 检查给定值是否为字符串。\r\n * @param {unknown} value 要检查的值\r\n * @returns {value is string} 如果是字符串则返回 true，否则返回 false\r\n */\r\nexport function isString(value: unknown): value is string {\r\n  return getType(value) === 'string'\r\n}\r\n\r\n/**\r\n * 否是数值\r\n * @param {*} value\r\n */\r\nexport function isNumber(value: any): value is number {\r\n  return getType(value) === 'number'\r\n}\r\n\r\n/**\r\n * 检查给定值是否为 Promise 对象。\r\n * @param {unknown} value 要检查的值\r\n * @returns {value is Promise<any>} 如果是 Promise 对象则返回 true，否则返回 false\r\n */\r\nexport function isPromise(value: unknown): value is Promise<any> {\r\n  // 先将 value 断言为 object 类型\r\n  if (isObj(value) && isDef(value)) {\r\n    // 然后进一步检查 value 是否具有 then 和 catch 方法，并且它们是函数类型\r\n    return isFunction((value as Promise<any>).then) && isFunction((value as Promise<any>).catch)\r\n  }\r\n  return false // 如果 value 不是对象类型，则肯定不是 Promise\r\n}\r\n\r\n/**\r\n * 检查给定的值是否为布尔类型\r\n * @param value 要检查的值\r\n * @returns 如果值为布尔类型，则返回true，否则返回false\r\n */\r\nexport function isBoolean(value: any): value is boolean {\r\n  return typeof value === 'boolean'\r\n}\r\n\r\nexport function isUndefined(value: any): value is undefined {\r\n  return typeof value === 'undefined'\r\n}\r\n\r\nexport function isNotUndefined<T>(value: T): value is NotUndefined<T> {\r\n  return !isUndefined(value)\r\n}\r\n\r\n/**\r\n * 检查给定的值是否为奇数\r\n * @param value 要检查的值\r\n * @returns\r\n */\r\nexport function isOdd(value: number): boolean {\r\n  if (typeof value !== 'number') {\r\n    throw new Error('输入必须为数字')\r\n  }\r\n\r\n  // 使用取模运算符来判断是否为奇数\r\n  // 如果 number 除以 2 的余数为 1，就是奇数\r\n  // 否则是偶数\r\n  return value % 2 === 1\r\n}\r\n\r\n/**\r\n * 是否为base64图片\r\n * @param {string} url\r\n * @return\r\n */\r\nexport function isBase64Image(url: string) {\r\n  // 使用正则表达式检查URL是否以\"data:image\"开头，这是Base64图片的常见前缀\r\n  return /^data:image\\/(png|jpg|jpeg|gif|bmp);base64,/.test(url)\r\n}\r\n\r\n/**\r\n * 将外部传入的样式格式化为可读的 CSS 样式。\r\n * @param {object | object[]} styles 外部传入的样式对象或数组\r\n * @returns {string} 格式化后的 CSS 样式字符串\r\n */\r\nexport function objToStyle(styles: Record<string, any> | Record<string, any>[]): string {\r\n  // 如果 styles 是数组类型\r\n  if (isArray(styles)) {\r\n    // 使用过滤函数去除空值和 null 值的元素\r\n    // 对每个非空元素递归调用 objToStyle，然后通过分号连接\r\n    const result = styles\r\n      .filter(function (item) {\r\n        return item != null && item !== ''\r\n      })\r\n      .map(function (item) {\r\n        return objToStyle(item)\r\n      })\r\n      .join(';')\r\n\r\n    // 如果结果不为空，确保末尾有分号\r\n    return result ? (result.endsWith(';') ? result : result + ';') : ''\r\n  }\r\n\r\n  if (isString(styles)) {\r\n    // 如果是字符串且不为空，确保末尾有分号\r\n    return styles ? (styles.endsWith(';') ? styles : styles + ';') : ''\r\n  }\r\n\r\n  // 如果 styles 是对象类型\r\n  if (isObj(styles)) {\r\n    // 使用 Object.keys 获取所有属性名\r\n    // 使用过滤函数去除值为 null 或空字符串的属性\r\n    // 对每个属性名和属性值进行格式化，通过分号连接\r\n    const result = Object.keys(styles)\r\n      .filter(function (key) {\r\n        return styles[key] != null && styles[key] !== ''\r\n      })\r\n      .map(function (key) {\r\n        // 使用 kebabCase 函数将属性名转换为 kebab-case 格式\r\n        // 将属性名和属性值格式化为 CSS 样式的键值对\r\n        return [kebabCase(key), styles[key]].join(':')\r\n      })\r\n      .join(';')\r\n\r\n    // 如果结果不为空，确保末尾有分号\r\n    return result ? (result.endsWith(';') ? result : result + ';') : ''\r\n  }\r\n  // 如果 styles 不是对象也不是数组，则直接返回\r\n  return ''\r\n}\r\n\r\n/**\r\n * 判断一个对象是否包含任何字段\r\n * @param obj 要检查的对象\r\n * @returns {boolean} 如果对象为空（不包含任何字段）则返回 true，否则返回 false\r\n */\r\nexport function hasFields(obj: unknown): boolean {\r\n  // 如果不是对象类型或为 null，则认为没有字段\r\n  if (!isObj(obj) || obj === null) {\r\n    return false\r\n  }\r\n\r\n  // 使用 Object.keys 检查对象是否有属性\r\n  return Object.keys(obj).length > 0\r\n}\r\n\r\n/**\r\n * 判断一个对象是否为空对象（不包含任何字段）\r\n * @param obj 要检查的对象\r\n * @returns {boolean} 如果对象为空（不包含任何字段）则返回 true，否则返回 false\r\n */\r\nexport function isEmptyObj(obj: unknown): boolean {\r\n  return !hasFields(obj)\r\n}\r\n\r\nexport const requestAnimationFrame = (cb = () => {}) => {\r\n  return new AbortablePromise((resolve) => {\r\n    const timer = setInterval(() => {\r\n      clearInterval(timer)\r\n      resolve(true)\r\n      cb()\r\n    }, 1000 / 30)\r\n  })\r\n}\r\n\r\n/**\r\n * 暂停指定时间函数\r\n * @param ms 延迟时间\r\n * @returns\r\n */\r\nexport const pause = (ms: number = 1000 / 30) => {\r\n  return new AbortablePromise((resolve) => {\r\n    const timer = setTimeout(() => {\r\n      clearTimeout(timer)\r\n      resolve(true)\r\n    }, ms)\r\n  })\r\n}\r\n\r\n/**\r\n * 深拷贝函数，用于将对象进行完整复制。\r\n * @param obj 要深拷贝的对象\r\n * @param cache 用于缓存已复制的对象，防止循环引用\r\n * @returns 深拷贝后的对象副本\r\n */\r\nexport function deepClone<T>(obj: T, cache: Map<any, any> = new Map()): T {\r\n  // 如果对象为 null 或或者不是对象类型，则直接返回该对象\r\n  if (obj === null || typeof obj !== 'object') {\r\n    return obj\r\n  }\r\n\r\n  // 处理特殊对象类型：日期、正则表达式、错误对象\r\n  if (isDate(obj)) {\r\n    return new Date(obj.getTime()) as any\r\n  }\r\n  if (obj instanceof RegExp) {\r\n    return new RegExp(obj.source, obj.flags) as any\r\n  }\r\n  if (obj instanceof Error) {\r\n    const errorCopy = new Error(obj.message) as any\r\n    errorCopy.stack = obj.stack\r\n    return errorCopy\r\n  }\r\n\r\n  // 检查缓存中是否已存在该对象的复制\r\n  if (cache.has(obj)) {\r\n    return cache.get(obj)\r\n  }\r\n\r\n  // 根据原始对象的类型创建对应的空对象或数组\r\n  const copy: any = Array.isArray(obj) ? [] : {}\r\n\r\n  // 将当前对象添加到缓存中\r\n  cache.set(obj, copy)\r\n\r\n  // 递归地深拷贝对象的每个属性\r\n  for (const key in obj) {\r\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\r\n      copy[key] = deepClone(obj[key], cache)\r\n    }\r\n  }\r\n\r\n  return copy as T\r\n}\r\n\r\n/**\r\n * 深度合并两个对象。\r\n * @param target 目标对象，将合并的结果存放在此对象中\r\n * @param source 源对象，要合并到目标对象的对象\r\n * @returns 合并后的目标对象\r\n */\r\nexport function deepMerge<T extends Record<string, any>>(target: T, source: Record<string, any>): T {\r\n  // 深拷贝目标对象，避免修改原始对象\r\n  target = deepClone(target)\r\n\r\n  // 检查目标和源是否都是对象类型\r\n  if (typeof target !== 'object' || typeof source !== 'object') {\r\n    throw new Error('Both target and source must be objects.')\r\n  }\r\n\r\n  // 遍历源对象的属性\r\n  for (const prop in source) {\r\n    // eslint-disable-next-line no-prototype-builtins\r\n    if (!source.hasOwnProperty(prop))\r\n      continue\r\n      // 使用类型断言，告诉 TypeScript 这是有效的属性\r\n    ;(target as Record<string, any>)[prop] = source[prop]\r\n  }\r\n\r\n  return target\r\n}\r\n\r\n/**\r\n * 深度合并两个对象。\r\n * @param target\r\n * @param source\r\n * @returns\r\n */\r\nexport function deepAssign(target: Record<string, any>, source: Record<string, any>): Record<string, any> {\r\n  Object.keys(source).forEach((key) => {\r\n    const targetValue = target[key]\r\n    const newObjValue = source[key]\r\n    if (isObj(targetValue) && isObj(newObjValue)) {\r\n      deepAssign(targetValue, newObjValue)\r\n    } else {\r\n      target[key] = newObjValue\r\n    }\r\n  })\r\n  return target\r\n}\r\n\r\n/**\r\n * 构建带参数的URL\r\n * @param baseUrl 基础URL\r\n * @param params 参数对象，键值对表示要添加到URL的参数\r\n * @returns 返回带有参数的URL\r\n */\r\nexport function buildUrlWithParams(baseUrl: string, params: Record<string, string>) {\r\n  // 将参数对象转换为查询字符串\r\n  const queryString = Object.entries(params)\r\n    .map(([key, value]) => `${key}=${encodeURIComponent(value)}`)\r\n    .join('&')\r\n\r\n  // 检查基础URL是否已包含查询字符串，并选择适当的分隔符\r\n  const separator = baseUrl.includes('?') ? '&' : '?'\r\n\r\n  // 返回带有参数的URL\r\n  return `${baseUrl}${separator}${queryString}`\r\n}\r\n\r\ntype DebounceOptions = {\r\n  leading?: boolean // 是否在延迟时间开始时调用函数\r\n  trailing?: boolean // 是否在延迟时间结束时调用函数\r\n}\r\n\r\nexport function debounce<T extends (...args: any[]) => any>(func: T, wait: number, options: DebounceOptions = {}): T {\r\n  let timeoutId: ReturnType<typeof setTimeout> | null = null\r\n  let lastArgs: any[] | undefined\r\n  let lastThis: any\r\n  let result: ReturnType<T> | undefined\r\n  const leading = isDef(options.leading) ? options.leading : false\r\n  const trailing = isDef(options.trailing) ? options.trailing : true\r\n\r\n  function invokeFunc() {\r\n    if (lastArgs !== undefined) {\r\n      result = func.apply(lastThis, lastArgs)\r\n      lastArgs = undefined\r\n    }\r\n  }\r\n\r\n  function startTimer() {\r\n    timeoutId = setTimeout(() => {\r\n      timeoutId = null\r\n      if (trailing) {\r\n        invokeFunc()\r\n      }\r\n    }, wait)\r\n  }\r\n\r\n  function cancelTimer() {\r\n    if (timeoutId !== null) {\r\n      clearTimeout(timeoutId)\r\n      timeoutId = null\r\n    }\r\n  }\r\n\r\n  function debounced(this: any, ...args: Parameters<T>): ReturnType<T> | undefined {\r\n    lastArgs = args\r\n    lastThis = this\r\n\r\n    if (timeoutId === null) {\r\n      if (leading) {\r\n        invokeFunc()\r\n      }\r\n      startTimer()\r\n    } else if (trailing) {\r\n      cancelTimer()\r\n      startTimer()\r\n    }\r\n\r\n    return result\r\n  }\r\n\r\n  return debounced as T\r\n}\r\n\r\n// eslint-disable-next-line @typescript-eslint/ban-types\r\nexport function throttle(func: Function, wait: number): Function {\r\n  let timeout: ReturnType<typeof setTimeout> | null = null\r\n  let previous: number = 0\r\n\r\n  const throttled = function (this: any, ...args: any[]) {\r\n    const now = Date.now()\r\n    const remaining = wait - (now - previous)\r\n\r\n    if (remaining <= 0) {\r\n      if (timeout) {\r\n        clearTimeout(timeout)\r\n        timeout = null\r\n      }\r\n      previous = now\r\n      func.apply(this, args)\r\n    } else if (!timeout) {\r\n      timeout = setTimeout(() => {\r\n        previous = Date.now()\r\n        timeout = null\r\n        func.apply(this, args)\r\n      }, remaining)\r\n    }\r\n  }\r\n\r\n  return throttled\r\n}\r\n\r\n/**\r\n * 根据属性路径获取对象中的属性值\r\n * @param obj 目标对象\r\n * @param path 属性路径，可以是字符串或字符串数组\r\n * @returns 属性值，如果属性不存在或中间的属性为 null 或 undefined，则返回 undefined\r\n */\r\nexport const getPropByPath = (obj: any, path: string): any => {\r\n  const keys: string[] = path.split('.')\r\n\r\n  try {\r\n    return keys.reduce((acc: any, key: string) => (acc !== undefined && acc !== null ? acc[key] : undefined), obj)\r\n  } catch (error) {\r\n    return undefined\r\n  }\r\n}\r\n\r\n/**\r\n * 检查一个值是否为Date类型\r\n * @param val 要检查的值\r\n * @returns 如果值是Date类型，则返回true，否则返回false\r\n */\r\nexport const isDate = (val: unknown): val is Date => Object.prototype.toString.call(val) === '[object Date]' && !Number.isNaN((val as Date).getTime())\r\n\r\n/**\r\n * 检查提供的URL是否为视频链接。\r\n * @param url 需要检查的URL字符串。\r\n * @returns 返回一个布尔值，如果URL是视频链接则为true，否则为false。\r\n */\r\nexport function isVideoUrl(url: string): boolean {\r\n  // 使用正则表达式匹配视频文件类型的URL\r\n  const videoRegex = /\\.(mp4|mpg|mpeg|dat|asf|avi|rm|rmvb|mov|wmv|flv|mkv|video)/i\r\n  return videoRegex.test(url)\r\n}\r\n\r\n/**\r\n * 检查提供的URL是否为图片URL。\r\n * @param url 待检查的URL字符串。\r\n * @returns 返回一个布尔值，如果URL是图片格式，则为true；否则为false。\r\n */\r\nexport function isImageUrl(url: string): boolean {\r\n  // 使用正则表达式匹配图片URL\r\n  const imageRegex = /\\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg|image)/i\r\n  return imageRegex.test(url)\r\n}\r\n\r\n/**\r\n * 判断环境是否是H5\r\n */\r\nexport const isH5 = (() => {\r\n  let isH5 = false\r\n  // #ifdef H5\r\n  isH5 = true\r\n  // #endif\r\n  return isH5\r\n})()\r\n\r\n/**\r\n * 剔除对象中的某些属性\r\n * @param obj\r\n * @param predicate\r\n * @returns\r\n */\r\nexport function omitBy<O extends Record<string, any>>(obj: O, predicate: (value: any, key: keyof O) => boolean): Partial<O> {\r\n  const newObj = deepClone(obj)\r\n  Object.keys(newObj).forEach((key) => predicate(newObj[key], key) && delete newObj[key]) // 遍历对象的键，删除值为不满足predicate的字段\r\n  return newObj\r\n}\r\n\r\n/**\r\n * 缓动函数，用于在动画或过渡效果中根据时间参数计算当前值\r\n * @param t 当前时间，通常是从动画开始经过的时间\r\n * @param b 初始值，动画属性的初始值\r\n * @param c 变化量，动画属性的目标值与初始值的差值\r\n * @param d 持续时间，动画持续的总时间长度\r\n * @returns 计算出的当前值\r\n */\r\nexport function easingFn(t: number = 0, b: number = 0, c: number = 0, d: number = 0): number {\r\n  return (c * (-Math.pow(2, (-10 * t) / d) + 1) * 1024) / 1023 + b\r\n}\r\n\r\n/**\r\n * 从数组中寻找最接近目标值的元素\r\n *\r\n * @param arr 数组\r\n * @param target 目标值\r\n * @returns 最接近目标值的元素\r\n */\r\nexport function closest(arr: number[], target: number) {\r\n  return arr.reduce((prev, curr) => (Math.abs(curr - target) < Math.abs(prev - target) ? curr : prev))\r\n}\r\n"],"names":["uni","AbortablePromise"],"mappings":"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"}