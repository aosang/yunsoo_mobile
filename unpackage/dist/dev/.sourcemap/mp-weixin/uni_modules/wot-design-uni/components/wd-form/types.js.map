{"version":3,"file":"types.js","sources":["uni_modules/wot-design-uni/components/wd-form/types.ts"],"sourcesContent":["/*\r\n * @Author: weisheng\r\n * @Date: 2023-12-14 11:21:58\r\n * @LastEditTime: 2025-01-11 13:31:20\r\n * @LastEditors: weisheng\r\n * @Description:\r\n * @FilePath: /wot-design-uni/src/uni_modules/wot-design-uni/components/wd-form/types.ts\r\n * 记得注释\r\n */\r\nimport { type ComponentPublicInstance, type ExtractPropTypes, type InjectionKey, type PropType } from 'vue'\r\nimport { baseProps, makeBooleanProp, makeRequiredProp } from '../common/props'\r\n\r\nexport type FormProvide = {\r\n  props: {\r\n    model: Record<string, any>\r\n    rules?: FormRules\r\n    border?: boolean\r\n  }\r\n  errorMessages?: Record<string, string>\r\n}\r\n\r\nexport const FORM_KEY: InjectionKey<FormProvide> = Symbol('wd-form')\r\n\r\nexport type FormRules = {\r\n  [key: string]: FormItemRule[]\r\n}\r\n\r\nexport type ErrorMessage = {\r\n  prop: string\r\n  message: string\r\n}\r\n\r\nexport interface FormItemRule {\r\n  [key: string]: any\r\n  required: boolean\r\n  message: string\r\n  pattern?: RegExp\r\n  validator?: (value: any, rule: FormItemRuleWithoutValidator) => boolean | Promise<string> | Promise<boolean> | Promise<void> | Promise<unknown>\r\n}\r\n\r\nexport type FormItemRuleWithoutValidator = Omit<FormItemRule, 'validator'>\r\n\r\nexport const formProps = {\r\n  ...baseProps,\r\n  /**\r\n   * 表单数据对象\r\n   */\r\n  model: makeRequiredProp(Object as PropType<Record<string, any>>),\r\n  /**\r\n   * 表单验证规则\r\n   */\r\n  rules: {\r\n    type: Object as PropType<FormRules>,\r\n    default: () => ({})\r\n  },\r\n  /**\r\n   * 是否在输入时重置表单校验信息\r\n   */\r\n  resetOnChange: makeBooleanProp(true),\r\n  /**\r\n   * 错误提示类型\r\n   */\r\n  errorType: {\r\n    type: String as PropType<'toast' | 'message' | 'none'>,\r\n    default: 'message'\r\n  }\r\n}\r\nexport type FormProps = ExtractPropTypes<typeof formProps>\r\n\r\nexport type FormExpose = {\r\n  /**\r\n   * 表单校验\r\n   * @param prop 指定校验字段\r\n   */\r\n  validate: (prop?: string | Array<string>) => Promise<{\r\n    valid: boolean\r\n    errors: ErrorMessage[]\r\n  }>\r\n  /**\r\n   * 重置表单项的验证提示\r\n   */\r\n  reset: () => void\r\n}\r\n\r\nexport type FormInstance = ComponentPublicInstance<FormProps, FormExpose>\r\n"],"names":["baseProps","makeRequiredProp","makeBooleanProp"],"mappings":";;AAqBa,MAAA,WAAsC,OAAO,SAAS;AAAA,CAqB1C;AAAA,EACvB,GAAGA,iDAAA;AAAA;AAAA;AAAA;AAAA,EAIH,OAAOC,kEAAiB,MAAuC;AAAA;AAAA;AAAA;AAAA,EAI/D,OAAO;AAAA,IACL,MAAM;AAAA,IACN,SAAS,OAAO,CAAA;AAAA,EAClB;AAAA;AAAA;AAAA;AAAA,EAIA,eAAeC,iEAAgB,IAAI;AAAA;AAAA;AAAA;AAAA,EAInC,WAAW;AAAA,IACT,MAAM;AAAA,IACN,SAAS;AAAA,EACX;AACF;;"}